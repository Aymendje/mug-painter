<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mug Painter</title>
    <link rel="icon" type="image/svg+xml" href="https://www.svgrepo.com/download/245216/mug-coffee.svg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="text-slate-800 flex items-center justify-center min-h-screen p-4 sm:p-6">

    <main class="w-full max-w-6xl mx-auto">
        <div class="text-center mb-10 relative">
            <!-- Dark Mode Toggle -->
            <button id="darkModeToggle" class="absolute top-0 right-0 p-2 rounded-lg transition-colors hover:bg-slate-100 dark:hover:bg-slate-700" title="Toggle Dark Mode">
                <svg class="w-5 h-5 dark:hidden" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                </svg>
                <svg class="w-5 h-5 hidden dark:block" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                </svg>
            </button>
            
            <h1 class="text-4xl font-bold text-slate-900 dark:text-slate-100 flex items-center justify-center gap-3">
                <img src="https://www.svgrepo.com/download/245216/mug-coffee.svg" alt="Mug Icon" class="w-10 h-10">
                Mug Painter : Wrap Generator for Mugs
            </h1>
            <p class="mt-2 text-lg text-slate-600 dark:text-slate-400">Design and export custom templates for your sublimation projects.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Left Column: Controls -->
            <div class="grid grid-cols-1 gap-8">
                 <!-- Project Name -->
                <div class="card">
                    <h2 class="text-xl font-semibold text-slate-900 mb-4">Project Name</h2>
                    <div class="input-group">
                        <label for="projectName" class="font-medium text-sm text-slate-700">Enter a filename for your project.</label>
                        <div class="flex gap-2">
                            <input type="text" id="projectName" value="" class="input-field flex-grow">
                            <input type="file" id="loadProjectInput" class="hidden" accept=".svg,.mugproj">
                            <button id="loadProjectBtn" class="btn btn-secondary" title="Load Project">
                                üìÅ Load
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Mug Dimensions -->
                <div class="card">
                    <h2 class="text-xl font-semibold text-slate-900 mb-4">1. Mug Dimensions</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="input-group">
                            <label for="mugHeight" class="font-medium text-sm text-slate-700">Height (mm)</label>
                            <input type="number" id="mugHeight" value="96.2" class="input-field w-full">
                        </div>
                        <div class="input-group">
                            <label for="mugDiameter" class="font-medium text-sm text-slate-700">Diameter (mm)</label>
                            <input type="number" id="mugDiameter" value="84.0" class="input-field w-full">
                        </div>
                         <div class="input-group sm:col-span-2 lg:col-span-1">
                            <label for="handleAreaWidth" class="font-medium text-sm text-slate-700">Handle Width (mm)</label>
                            <input type="number" id="handleAreaWidth" value="15.4" class="input-field w-full">
                        </div>
                    </div>
                </div>

                <!-- Background Options -->
                <div class="card">
                    <h2 class="text-xl font-semibold text-slate-900 mb-4">2. Background Style</h2>
                    <div class="flex justify-center flex-wrap gap-4 mb-4">
                        <label>
                            <input type="radio" name="backgroundType" value="transparent" class="radio-input sr-only" checked>
                            <span class="radio-label">None</span>
                        </label>
                        <label>
                            <input type="radio" name="backgroundType" value="color" class="radio-input sr-only">
                            <span class="radio-label">Color</span>
                        </label>
                        <label>
                            <input type="radio" name="backgroundType" value="image" class="radio-input sr-only">
                            <span class="radio-label">Image</span>
                        </label>
                    </div>
                    <div class="flex justify-center items-center min-h-[48px]">
                        <div id="bg-none-controls" class="flex items-center gap-2">
                            <div class="w-64 h-12 bg-gray rounded-md checkerboard"></div>
                        </div>
                        <div id="bg-color-controls" class="hidden items-center gap-2">
                            <input type="color" id="bgColorPicker" value="#BFDBFE" class="h-12 w-64 border-gray-300 rounded-md p-1 cursor-pointer">
                        </div>
                        <div id="bg-image-controls" class="hidden flex flex-wrap items-center gap-2">
                             <input type="file" id="bgImageUpload" class="hidden" accept="image/*,.svg">
                             <button id="bgUploadBtn" class="btn btn-secondary h-12">
                                Upload Background
                            </button>
                            <select id="bgImageStyle" class="select-field h-12" selected="fill">
                                <option value="fill">Fill</option>
                                <option value="fit">Fit</option>
                                <option value="stretch">Stretch</option>
                                <option value="tile">Tile</option>
                                <option value="center">Center</option>
                            </select>
                            <select id="bgImageSize" class="select-field h-12" selected="original">
                                <option value="original">Original</option>
                                <option value="xs">Extra Small</option>
                                <option value="s">Small</option>
                                <option value="m">Medium</option>
                                <option value="l">Large</option>
                                <option value="xl">Extra Large</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Image Uploads -->
                <div class="card">
                    <h2 class="text-xl font-semibold text-slate-900 mb-4">3. Add Artwork</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Back Image Card -->
                         <div class="sub-card space-y-4">
                            <h3 class="font-semibold text-slate-800 text-center">Back of the Mug</h3>
                            <div class="flex justify-center flex-wrap gap-4">
                                <label><input type="radio" name="backArtType" value="transparent" class="radio-input sr-only" checked><span class="radio-label">None</span></label>
                                <label><input type="radio" name="backArtType" value="image" class="radio-input sr-only"><span class="radio-label">Image</span></label>
                                <label><input type="radio" name="backArtType" value="text" class="radio-input sr-only"><span class="radio-label">Text</span></label>
                            </div>
                            <div id="back-image-controls" class="hidden space-y-3">
                                <input type="file" id="backImageInput" class="hidden" accept="image/*,.svg">
                                <button id="uploadBackBtn" class="btn btn-secondary w-full">Upload</button>
                                <div class="flex gap-2 justify-center">
                                    <button id="flipBackHBtn" class="btn btn-secondary btn-icon" title="Flip Horizontal"><img src="https://www.svgrepo.com/download/509931/flip-horizontal.svg" class="w-5 h-5" alt="Flip Horizontal"></button>
                                    <button id="flipBackVBtn" class="btn btn-secondary btn-icon" title="Flip Vertical"><img src="https://www.svgrepo.com/download/509932/flip-vertical.svg" class="w-5 h-5" alt="Flip Vertical"></button>
                                    <button id="rotateBackLBtn" class="btn btn-secondary btn-icon" title="Rotate Left"><img src="https://www.svgrepo.com/download/501707/rotate-left.svg" class="w-5 h-5" alt="Rotate Left"></button>
                                    <button id="rotateBackRBtn" class="btn btn-secondary btn-icon" title="Rotate Right"><img src="https://www.svgrepo.com/download/501709/rotate-right.svg" class="w-5 h-5" alt="Rotate Right"></button>
                                </div>
                            </div>
                            <div id="back-text-controls" class="hidden space-y-3">
                                <textarea id="backTextInput" class="textarea-field w-full" rows="3" placeholder="Your text here..."></textarea>
                                <div class="flex gap-2">
                                    <div class="custom-select flex-grow" id="backFontSelect">
                                        <div class="custom-select-trigger">
                                            <span>Roboto</span>
                                            <div class="arrow">‚ñº</div>
                                        </div>
                                        <div class="custom-options">
                                            <!-- Options will be populated by JavaScript -->
                                        </div>
                                    </div>
                                    <input type="color" id="backColorPicker" value="#000000" class="h-10 w-16 border-gray-300 rounded-md p-1 cursor-pointer">
                                </div>
                                <div class="flex gap-2 justify-center">
                                    <button id="backBoldBtn" class="btn btn-secondary btn-icon" title="Bold"><b>B</b></button>
                                    <button id="backItalicBtn" class="btn btn-secondary btn-icon" title="Italic"><i>I</i></button>
                                    <button id="backUnderlineBtn" class="btn btn-secondary btn-icon" title="Underline"><u>U</u></button>
                                </div>
                                <div class="flex gap-2 justify-center">
                                    <button id="backStrikethroughBtn" class="btn btn-secondary btn-icon" title="Strikethrough"><s>S</s></button>
                                    <button id="backContourBtn" class="btn btn-secondary btn-icon" title="Contour"><img src="https://www.svgrepo.com/download/403767/letter-c.svg" class="w-4 h-4" alt="Contour"></button>
                                    <button id="backFlipTextBtn" class="btn btn-secondary btn-icon" title="Flip Horizontal"><img src="https://www.svgrepo.com/download/509931/flip-horizontal.svg" class="w-4 h-4" alt="Flip"></button>
                                </div>
                                <div id="back-contour-controls" class="hidden flex flex-col gap-2 justify-center items-center mt-2">
                                    <div class="flex gap-2 items-center">
                                        <label class="font-medium text-sm text-slate-700">Contour Color:</label>
                                        <input type="color" id="backContourColorPicker" value="#000000" class="h-8 w-16 border-gray-300 rounded-md p-1 cursor-pointer">
                                    </div>
                                    <div class="flex gap-2 items-center">
                                        <label class="font-medium text-sm text-slate-700">Thickness:</label>
                                        <input type="range" id="backContourThickness" min="1" max="10" value="2" class="w-24">
                                        <span id="backContourThicknessValue" class="text-sm text-slate-600 w-6">2</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Face Image Card -->
                        <div class="sub-card space-y-4">
                            <h3 class="font-semibold text-slate-800 text-center">Front of the Mug</h3>
                            <div class="flex justify-center flex-wrap gap-4">
                                <label><input type="radio" name="faceArtType" value="transparent" class="radio-input sr-only" checked><span class="radio-label">None</span></label>
                                <label><input type="radio" name="faceArtType" value="image" class="radio-input sr-only"><span class="radio-label">Image</span></label>
                                <label><input type="radio" name="faceArtType" value="text" class="radio-input sr-only"><span class="radio-label">Text</span></label>
                            </div>
                            <div id="face-image-controls" class="hidden space-y-3">
                                <input type="file" id="faceImageInput" class="hidden" accept="image/*,.svg">
                                <button id="uploadFaceBtn" class="btn btn-secondary w-full">Upload</button>
                                <div class="flex gap-2 justify-center">
                                    <button id="flipFaceHBtn" class="btn btn-secondary btn-icon" title="Flip Horizontal"><img src="https://www.svgrepo.com/download/509931/flip-horizontal.svg" class="w-5 h-5" alt="Flip Horizontal"></button>
                                    <button id="flipFaceVBtn" class="btn btn-secondary btn-icon" title="Flip Vertical"><img src="https://www.svgrepo.com/download/509932/flip-vertical.svg" class="w-5 h-5" alt="Flip Vertical"></button>
                                    <button id="rotateFaceLBtn" class="btn btn-secondary btn-icon" title="Rotate Left"><img src="https://www.svgrepo.com/download/501707/rotate-left.svg" class="w-5 h-5" alt="Rotate Left"></button>
                                    <button id="rotateFaceRBtn" class="btn btn-secondary btn-icon" title="Rotate Right"><img src="https://www.svgrepo.com/download/501709/rotate-right.svg" class="w-5 h-5" alt="Rotate Right"></button>
                                </div>
                            </div>
                             <div id="face-text-controls" class="hidden space-y-3">
                                <textarea id="faceTextInput" class="textarea-field w-full" rows="3" placeholder="Your text here..."></textarea>
                                <div class="flex gap-2">
                                    <div class="custom-select flex-grow" id="faceFontSelect">
                                        <div class="custom-select-trigger">
                                            <span>Roboto</span>
                                            <div class="arrow">‚ñº</div>
                                        </div>
                                        <div class="custom-options">
                                            <!-- Options will be populated by JavaScript -->
                                        </div>
                                    </div>
                                    <input type="color" id="faceColorPicker" value="#000000" class="h-10 w-16 border-gray-300 rounded-md p-1 cursor-pointer">
                                </div>
                                <div class="flex gap-2 justify-center">
                                    <button id="faceBoldBtn" class="btn btn-secondary btn-icon" title="Bold"><b>B</b></button>
                                    <button id="faceItalicBtn" class="btn btn-secondary btn-icon" title="Italic"><i>I</i></button>
                                    <button id="faceUnderlineBtn" class="btn btn-secondary btn-icon" title="Underline"><u>U</u></button>
                                </div>
                                <div class="flex gap-2 justify-center">
                                    <button id="faceStrikethroughBtn" class="btn btn-secondary btn-icon" title="Strikethrough"><s>S</s></button>
                                    <button id="faceContourBtn" class="btn btn-secondary btn-icon" title="Contour"><img src="https://www.svgrepo.com/download/403767/letter-c.svg" class="w-4 h-4" alt="Contour"></button>
                                    <button id="faceFlipTextBtn" class="btn btn-secondary btn-icon" title="Flip Horizontal"><img src="https://www.svgrepo.com/download/509931/flip-horizontal.svg" class="w-4 h-4" alt="Flip"></button>
                                </div>
                                <div id="face-contour-controls" class="hidden flex flex-col gap-2 justify-center items-center mt-2">
                                    <div class="flex gap-2 items-center">
                                        <label class="font-medium text-sm text-slate-700">Contour Color:</label>
                                        <input type="color" id="faceContourColorPicker" value="#000000" class="h-8 w-16 border-gray-300 rounded-md p-1 cursor-pointer">
                                    </div>
                                    <div class="flex gap-2 items-center">
                                        <label class="font-medium text-sm text-slate-700">Thickness:</label>
                                        <input type="range" id="faceContourThickness" min="1" max="10" value="2" class="w-24">
                                        <span id="faceContourThicknessValue" class="text-sm text-slate-600 w-6">2</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Preview & Download -->
            <div class="card space-y-6 md:sticky md:top-4 md:self-start">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-semibold text-slate-900">4. Preview & Export</h2>
                    <div class="flex gap-1 bg-slate-100 p-1 rounded-lg">
                        <button id="view2DBtn" class="btn btn-primary btn-sm px-3 py-1 text-sm">2D</button>
                        <button id="view3DBtn" class="btn btn-secondary btn-sm px-3 py-1 text-sm">3D</button>
                    </div>
                </div>
                <div id="svg-preview" class="border-2 border-dashed border-slate-300 rounded-lg p-4 bg-white w-full overflow-auto relative" style="min-height: 400px;">
                    <div id="svg-container" class="flex justify-center items-center">
                        <!-- SVG will be injected here -->
                    </div>
                    <canvas id="three-canvas" class="w-full h-full absolute inset-0 hidden"></canvas>
                </div>
                <div id="info" class="text-center text-sm text-slate-600 bg-slate-100 p-3 rounded-lg">
                    Adjust your mug's dimensions to see the template update in real-time.
                </div>
                <div class="input-group mb-2">
                    <label for="exportFormat" class="font-medium text-sm text-slate-700">Export Format</label>
                    <select id="exportFormat" class="select-field w-full">
                        <option value="svg" selected>SVG (Vector)</option>
                        <option value="png">PNG (Image)</option>
                        <option value="pdf">PDF (Document)</option>
                    </select>
                </div>
                <div class="input-group mb-2">
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" id="includeProjectData" checked class="rounded">
                        <span class="font-medium text-sm text-slate-700">Include project data for re-editing</span>
                    </label>
                    <p class="text-xs text-slate-500 mt-1">When enabled, exported files can be loaded back for further editing</p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="flex flex-col gap-1">
                        <button id="downloadCutoutBtn" class="btn btn-secondary w-full text-lg" disabled>
                            Download Cutout
                        </button>
                        <label class="flex items-center justify-center gap-1 cursor-pointer text-xs opacity-75 hover:opacity-100">
                            <input type="checkbox" id="exteriorOnlyMode" class="rounded text-xs w-3 h-3">
                            <span>Exterior only</span>
                        </label>
                    </div>
                    <button id="downloadDesignBtn" class="btn btn-primary w-full text-lg" disabled>
                        Download Design
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Modular JavaScript files -->
    <script type="module" src="js/main.js"></script>
</body>
</html>